\glsresetall
\chapter{Introduction}
\label{chap:introduction}

This document presents the \textit{Master Thesis} in \textit{Informatics Engineering} of the student \textit{Andr√© Pascoal Bento} during the school year of 2018/2019, taking place in the \textit{\gls{dei}} of the \textit{University of Coimbra}.

\section{Context}
\label{sec:context}

In today's world, software systems tend to become more distributed as time move on, resulting in new approaches that lead to new solutions and new patterns of developing software. One way to solve this is to develop systems that have their components decoupled, creating software with ``small pieces'' connected to each other that encapsulate and provide a specific function in the larger service. This way of developing software is called Microservices and has become mainstream in the enterprise software development industry~\cite{Dragoni2017}. However, with this kind of approach, the systems complexity is increased as a whole because with more ``small pieces'', more connections are needed and with this more problems related to latency and requests become harder to detect, analyse and correct~\cite{DiFrancesco2017}.

To keep a history of the work performed by this kind of systems, multiple techniques like monitoring~\cite{Joyce1987}, logging~\cite{logging} and tracing~\cite{distributed_tracing} are adopted. Monitoring consists on measuring some aspects like, e.g., \gls{cpu} usage, hard drive usage and network latency of the entire system or of some specific node in a distributed system. Logging provides an overview to a discrete, event-triggered log. Finally, tracing is much similar to logging, however the focus is  registering the flow of execution of the program through several system modules and boundaries. Lastly, distributed tracing, shares the focus on preserving causality relationships, however, is geared towards the modern distributed environments, where state is partitioned over multiple, threads, processes, machines and even geographical locations. This last one is better explained in Subsection~\ref{subsec:distributed_tracing} - \nameref{subsec:distributed_tracing}. There are multiple approaches to gather information of this kind of systems, each with its benefits and disadvantages.

The main problem with this nowadays is that there are not many implemented tools for processing tracing data and none for performing analysis of this type of data. For monitoring it tend to be easier, because data is represented in charts and diagrams, however for logging and tracing it gets harder to manually analyse the data due to multiple factors like its complexity, plethora and increasing quantity of information. There are some visualisation tools for the \gls{devops} to use, like the ones presented in Subsection~\ref{subsec:distributed_tracing_tools}~-~\nameref{subsec:distributed_tracing_tools}, however none of them gets to the point of performing the analysis of the system using tracing, has they tend to be developed only for visualisation and display of tracing data in a more human readable way. Nevertheless, this is critical information about the system behaviour, and thus there is the need for performing automatic tracing analysis.

\section{Motivation}
\label{sec:motivation}

The motivation behind this work resides in exploring and develop ways to perform tracing analysis in microservice based systems. The analysis of this kind of systems tend to be very complex and hard to perform due to their properties and characteristics, as it is explained in Subsection~\ref{subsec:microservices} - \nameref{subsec:microservices}, and to the type of data to be analysed, presented in Subsections~\ref{subsec:distributed_tracing} - \nameref{subsec:distributed_tracing} and~\ref{subsec:traces_and_spans} - \nameref{subsec:traces_and_spans}.

\gls{devops} teams have lots of problems when they need to identify and understand problems with this systems. They usually detect the problems when the client complains about the quality of service, and after that \gls{devops} dive in monitoring metrics like, e.g, \gls{cpu} usage, usage, hard drive usage and network latency, and then in distributed tracing data visualisations and logs to find some explanation to what is causing the reported problem. This involves a very hard and tedious work of look-up through lots of data that represents the history of work performed by the system and, in most cases, this tedious work reveals like a big ``find a needle in the haystack'' problem. Some times, \gls{devops} can only perceive problems in some services and end up ``killing'' and rebooting these services which is wrong, however, due to lack of time and difficulty in identifying anomalous services precisely this is the best known approach.

Problems regarding the system operation are more common in distributed systems and their identification must be simplified. This need of simplification comes from the exponential increase in the amount of data needed to retain information and the increasing difficulty in manually managing distributed infrastructures. The work presented in this thesis, aims to perform a research around these needs and focus on presenting some solutions and methods to perform tracing analysis.

\section{Goals}
\label{sec:goals}

The main goals for this thesis consists on the main points exposed bellow:

\begin{enumerate}
    \item Search for existing technology and methodologies used to help \gls{devops} teams in their current daily work, with the objective of gathering the best practices about handling tracing data. Also, we aim to understand how these systems are used, what are their advantages and disadvantages to better know how we can use them to design and produce a possible solution capable of performing tracing analysis. From this we expect to learn the state of the field for this research, covering the core concepts related work and technologies, presented in Chapter~\ref{chap:state_of_the_art}~-~\nameref{chap:state_of_the_art}.
    \item Perform a research about the main needs of \gls{devops} teams, to better understand what are their biggest concerns that lead to their approaches when performing pinpointing of microservices based systems problems. Relate these approaches with related work in the area, with the objective of understanding what other companies and groups have done in the field of automatic tracing analysis. The processes used to tackle this type of data, their main difficulties and conclusions provide a better insight about the problem. From this we expected to have our research objectives clearly defined and a compilation of questions to be evaluated and answered, presented in Chapter~\ref{chap:research_objectives_and_approach}~-~\nameref{chap:research_objectives_and_approach}.
    \item Reason about all the gathered information, design and produce a possible solution that provides a different approach to perform tracing analysis. From this we expect first to propose a possible solution, presented in Chapter~\ref{chap:possible_solution}. The we implement it using state of the art technologies, feed it with tracing data provided by Huawei and collect results, presented in Chapter~\ref{chap:implementation_process}~-~\nameref{chap:implementation_process}. Finally, we provide conclusions to this research work in the last Chapter~\ref{chap:conclusions}~-~\nameref{chap:conclusions}.
\end{enumerate}

\section{Research Contributions}
\label{sec:research_contributions}

From the work presented on this thesis, the following research contributions were made:

\begin{itemize}
    \item \todo{Andre Bento, Jaime Correia, Ricardo Filipe, Filipe Araujo and Jorge Cardoso. On the Limits of Automated Analysis of OpenTracing. International Symposium on Network Computing and Applications (IEEE NCA 2019) (The paper is waiting review).}
\end{itemize}

\section{Document Structure}
\label{sec:document_structure}

This section presents the document structure in this report, with a brief explanation of the contents in every section. The current document contains a total of seven chapters, including this one, Chapter~\ref{chap:introduction}~-~\nameref{chap:introduction}. The remaining six of them are presented as follows:

\begin{itemize}
    \item In Chapter~\ref{chap:methodology}~-~\nameref{chap:methodology} are presented the elements involved in this work, with their contributions, has well as the work plan, with ``foreseen'' and ``real'' work plans comparison and analysis.
    \item In Chapter~\ref{chap:state_of_the_art}~-~\nameref{chap:state_of_the_art} the current state of the field for this kind of problem is presented. This chapter is divided in three sections. The first one, Section~\ref{sec:concepts}~-~\nameref{sec:concepts} introduces the reader to the core concepts to know as a requirement for a full understanding of the topics discussed in this thesis. The second, Section~\ref{sec:technologies}~-~\nameref{sec:technologies} presents the result of a research for current technologies, that are able to help solving this problem and produce a proposed solution to be implemented. Finally, Section~\ref{sec:related_work}~-~\nameref{sec:related_work} presents the reader to related researches produced in the field of distributed tracing data handling.
    \item In Chapter~\ref{chap:research_objectives_and_approach}~-~\nameref{chap:research_objectives_and_approach} we present how we tackled this problem, the main difficulties that were found and the objectives involved to solve the issues that are presented. Also, in this chapter, a compilation of questions are presented and evaluated with some reasoning about possible ways to answer them.
    \item In Chapter~\ref{chap:possible_solution}~-~\nameref{chap:possible_solution} a possible solution for the presented problem is exposed and explained in detail. This chapter is divided in four sections. The first one, Section~\ref{sec:functional_requirements}~-~\nameref{sec:functional_requirements}, expose the functional requirements with their corresponding priority levels and a brief explanation to every single one of them. The second one, Section~\ref{sec:quality_attributes}~-~\nameref{sec:quality_attributes}, contains the gathered non-functional requirements that were used to build the solution architecture. The third one, Section~\ref{sec:technical_restrictions}~-~\nameref{sec:technical_restrictions}, presents the defined technical restrictions for this project. The last one, Section~\ref{sec:architecture}~-~\nameref{sec:architecture}, presents the possible solution architecture using some representational diagrams, and ends with an analysis and validation to check if the presented architecture meets up the restrictions involved in the architectural drivers.
    \item In Chapter~\ref{chap:implementation_process}~-~\nameref{chap:implementation_process}, the implementation process of the possible solution is presented with detail. This chapter is divided in three main sections covering the whole implementation process, from the input data set through the pair of components presented in the previous chapter. The first one, Section~\ref{sec:huawei_tracing_data_set}~-~\nameref{sec:huawei_tracing_data_set}, the tracing data set provided by Huawei to be used as the core data for research is exposed with some detail. Second, in Section~\ref{sec:open_tracing_processor_component}~-~\nameref{sec:open_tracing_processor_component} we present the possible solution for the first component, namely ``Graphy \gls{otp}'', that processes and extracts metrics from tracing data. The final Section~\ref{sec:data_analysis_component}~-~\nameref{sec:data_analysis_component} presents the possible solution for the second component, namely ``Data Analyser'', that handles data produced by the first component and produces the analysis reports. Also, in the last two sections presented, the used algorithms and methods in the implementations are properly detailed and explained.
    \item In Chapter~\ref{chap:results_analysis_and_limitations}~-~\nameref{chap:research_objectives_and_approach}, the gathered results, corresponding analysis and limitations of tracing data are presented. This chapter is divided in three main sections. The first one, Section~\ref{sec:anomaly_detection}~-~\nameref{sec:anomaly_detection}, the results regarding the gathered observations on the extracted metrics of anomalous service detection are presented and explained. Second, in Section~\ref{sec:trace_quality_analysis}~-~\nameref{sec:trace_quality_analysis} the results obtained from the quality analysis methods applied to the tracing data set are presented and explained. The final Section~\ref{sec:limitations_of_opentracing_data}~-~\nameref{sec:limitations_of_opentracing_data} we present the limitations felted when designing a solution to process tracing data, more precisely OpenTracing data.
    \item Last, in Chapter~\ref{chap:conclusions}~-~\nameref{chap:conclusions}, the main conclusions for this research work are presented. The chapter is divided in three main sections. First, Section~\ref{sec:brief_reflections}~-~\nameref{sec:brief_reflections}, a reflection about the implemented tools, methods produced and the open paths from this research are exposed. Also a reflection of the main difficulties felted with this research regarding the handling of tracing data are presented. Second, Section~\ref{sec:future_work}~-~\nameref{sec:future_work}, the future work that can be addressed considering this work is properly explained taking into consideration what is said in the previous section. Finally, Section~\ref{sec:concluding_research_questions}~-~\nameref{sec:concluding_research_questions}, the state of answers for the selected questions defined in this research are discussed.
\end{itemize}

Next, Chapter~\ref{chap:methodology} - \nameref{chap:methodology}, the elements involved in this work, their contributions and work plans for this research project are presented.

\checkoddpage
\ifthenelse{\boolean{oddpage}}
{ % Odd page
    \newpage
    \blankpage}
{ % Even page
}